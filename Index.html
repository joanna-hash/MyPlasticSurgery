<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Best Plastic Surgery in Korea — Local Reviews (Sample)</title>
  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="" crossorigin=""/>
  <style>
    :root{
      --accent:#0f6fff;
      --muted:#6b7280;
      --card:#ffffff;
      --bg:#f5f7fb;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    body{ margin:0; background:var(--bg); color:#111827; }
    header{
      display:flex; align-items:center; gap:16px;
      padding:14px 18px; background:#fff; box-shadow:0 1px 0 rgba(16,24,40,0.04);
      position:sticky; top:0; z-index:40;
    }
    .logo{ font-weight:700; color:var(--accent); }
    .controls{ margin-left:auto; display:flex; gap:8px; align-items:center; }
    .btn{ background:var(--accent); color:#fff; padding:8px 12px; border-radius:8px; cursor:pointer; border:none; }
    .toggle { background:#eef2ff; color:var(--accent); padding:8px 12px; border-radius:8px; cursor:pointer; border:none; }
    main{ display:grid; grid-template-columns: 1fr 420px; gap:12px; padding:12px; height:calc(100vh - 68px); box-sizing:border-box; }
    /* left area holds map or list */
    #left { background:#fff; border-radius:10px; overflow:hidden; box-shadow:0 6px 18px rgba(15,23,42,0.06); }
    #map { width:100%; height:100%; min-height:300px; }
    /* right sidebar */
    #right { padding:12px; overflow:auto; }
    .search { display:flex; gap:8px; margin-bottom:10px; }
    .search input, .search select { padding:8px 10px; border-radius:8px; border:1px solid #e5e7eb; }
    .card { background:var(--card); border-radius:10px; padding:10px; margin-bottom:10px; box-shadow:0 1px 4px rgba(2,6,23,0.04); display:flex; gap:10px; }
    .card img{ width:100px; height:72px; object-fit:cover; border-radius:8px; }
    .card .meta{ flex:1; }
    .rating { color:#f59e0b; font-weight:700; }
    .badge { display:inline-block; padding:4px 8px; background:#eef2ff; color:var(--accent); border-radius:999px; font-size:12px; margin-right:6px; }
    .procedures { margin-top:6px; display:flex; gap:6px; flex-wrap:wrap; }
    footer{ padding:8px 12px; color:var(--muted); font-size:13px; text-align:center; }
    /* modal */
    .modal-backdrop{ position:fixed; inset:0; background:rgba(0,0,0,0.4); display:none; align-items:center; justify-content:center; z-index:80; }
    .modal{ width:960px; max-width:95%; max-height:90%; overflow:auto; background:#fff; border-radius:12px; padding:16px; box-shadow:0 10px 40px rgba(2,6,23,0.2); }
    .modal .gallery{ display:flex; gap:8px; margin-top:8px; }
    .modal .gallery img{ width:160px; height:100px; object-fit:cover; border-radius:8px; }
    .review{ padding:8px; border-top:1px solid #f3f4f6; }
    .chip { padding:6px 10px; background:#f3f4f6; border-radius:999px; font-size:13px; margin-right:6px; display:inline-block;}
    /* responsive */
    @media (max-width:980px){
      main{ grid-template-columns:1fr; height:auto; padding-bottom:80px; }
      #right{ order:2; }
      #left{ order:1; height:60vh; min-height:400px; }
    }
  </style>
</head>
<body>
  <header>
    <div class="logo">K-Clinic LocalReviews</div>
    <div style="font-size:13px;color:var(--muted)">Authentic local reviews (sample)</div>
    <div class="controls">
      <button id="viewMap" class="btn">Map View</button>
      <button id="viewList" class="toggle">Category View</button>
    </div>
  </header>

  <main>
    <div id="left">
      <div id="map" style="display:block"></div>
      <div id="list" style="display:none; padding:12px; height:100%; overflow:auto;">
        <h3 style="margin-top:0">Clinics by Procedure</h3>
        <div id="cards"></div>
      </div>
    </div>

    <aside id="right">
      <div class="search">
        <input id="q" placeholder="Search clinic name or location..." />
        <select id="procedureFilter">
          <option value="">All procedures</option>
        </select>
      </div>

      <div>
        <h4 style="margin:6px 0 6px 0">Top Clinics (sample)</h4>
        <div id="sidebarList"></div>
      </div>

      <hr style="margin:12px 0" />
      <!-- AdSense placeholder: put your ad script here -->
      <!-- Example:
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="ca-pub-XXXXXXXXXXXX"
             data-ad-slot="YYYYYYYY"
             data-ad-format="auto"></ins>
        <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
      -->
      <footer>
        Sample prototype • Data & images are mock/sample only • Deploy to GitHub Pages: push this file to repo and enable GitHub Pages (branch: main)
      </footer>
    </aside>
  </main>

  <!-- Modal -->
  <div id="modalRoot" class="modal-backdrop">
    <div class="modal" role="dialog" aria-modal="true">
      <button id="closeModal" style="float:right;background:#f3f4f6;border:0;padding:6px;border-radius:8px;cursor:pointer">Close</button>
      <h3 id="modalTitle"></h3>
      <div style="color:var(--muted); font-size:13px" id="modalAddr"></div>
      <div style="margin-top:8px">
        <span class="chip" id="modalRating"></span>
        <span id="modalDistance" style="color:var(--muted); margin-left:8px"></span>
      </div>
      <div class="gallery" id="modalGallery"></div>
      <h4 style="margin-top:12px">Reviews</h4>
      <div id="modalReviews"></div>
      <div style="margin-top:12px">
        <button id="openDirections" class="btn">Open in Maps</button>
      </div>
    </div>
  </div>

  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="" crossorigin=""></script>
  <script>
    // ---------- SAMPLE DATA ----------
    const clinics = [
      {
        id: "c1",
        name: "Seoul Aesthetic Clinic",
        name_kr: "서울에스테틱클리닉",
        lat: 37.4979,
        lng: 127.0276,
        address: "Gangnam-gu, Seoul",
        rating: 4.8,
        procedures: ["rhinoplasty","double-eyelid","filler"],
        images: [
          "https://picsum.photos/id/1011/800/600",
          "https://picsum.photos/id/1015/800/600",
          "https://picsum.photos/id/1025/800/600"
        ],
        reviews: [
          {author:"Jane", date:"2025-09-10", rating:5, text:"Excellent result for rhinoplasty. Staff spoke English and explained everything."},
          {author:"Mark", date:"2025-07-02", rating:5, text:"Clean clinic, fast recovery, photos before/after were authentic."}
        ]
      },
      {
        id: "c2",
        name: "Han River Plastic Surgery",
        name_kr: "한강성형외과",
        lat: 37.5139,
        lng: 127.0588,
        address: "Apgujeong / Seocho",
        rating: 4.5,
        procedures: ["liposuction","rhinoplasty"],
        images: [
          "https://picsum.photos/id/1027/800/600",
          "https://picsum.photos/id/1035/800/600"
        ],
        reviews: [
          {author:"Lina", date:"2025-06-21", rating:4, text:"Good pricing and follow-up, but appointment scheduling was a bit slow."}
        ]
      },
      {
        id: "c3",
        name: "Myeongdong Beauty Center",
        name_kr: "명동뷰티센터",
        lat: 37.5600,
        lng: 126.9860,
        address: "Myeongdong, Seoul",
        rating: 4.2,
        procedures: ["double-eyelid","filler","non-surgical"],
        images: [
          "https://picsum.photos/id/1041/800/600",
          "https://picsum.photos/id/1043/800/600"
        ],
        reviews: [
          {author:"Emma", date:"2025-08-05", rating:4, text:"Cosmetic injections were quick. English okay."}
        ]
      },
      {
        id: "c4",
        name: "Busan Aesthetic (sample out-of-seoul)",
        name_kr: "부산에스테틱",
        lat: 35.1796,
        lng: 129.0756,
        address: "Busan, Haeundae",
        rating: 4.7,
        procedures: ["rhinoplasty","scar-revision"],
        images: [
          "https://picsum.photos/id/1050/800/600"
        ],
        reviews: [
          {author:"Oliver", date:"2025-03-12", rating:5, text:"Great team, traveled from overseas and felt supported."}
        ]
      }
    ];

    // ---------- INIT UI ----------
    const procedureSet = new Set();
    clinics.forEach(c => c.procedures.forEach(p=>procedureSet.add(p)));
    const procList = Array.from(procedureSet).sort();

    const procedureFilter = document.getElementById('procedureFilter');
    procList.forEach(p=>{
      const opt = document.createElement('option');
      opt.value = p;
      opt.textContent = p.replace(/-/g, ' ');
      procedureFilter.appendChild(opt);
    });

    // sidebar list and cards
    const sidebarList = document.getElementById('sidebarList');
    const cards = document.getElementById('cards');

    function createCard(clinic){
      const div = document.createElement('div');
      div.className = 'card';
      div.innerHTML = `
        <img src="${clinic.images[0] || 'https://picsum.photos/200/150'}" alt="">
        <div class="meta">
          <div style="display:flex; justify-content:space-between; align-items:start">
            <div>
              <strong>${clinic.name}</strong><div style="font-size:13px; color:var(--muted)">${clinic.address}</div>
            </div>
            <div style="text-align:right">
              <div class="rating">${clinic.rating.toFixed(1)}</div>
              <div style="font-size:12px;color:var(--muted)">${clinic.reviews.length} reviews</div>
            </div>
          </div>
          <div class="procedures">
            ${clinic.procedures.map(p=>`<span class="badge">${p.replace(/-/g,' ')}</span>`).join('')}
          </div>
          <div style="margin-top:8px">
            <button class="btn" data-id="${clinic.id}">View</button>
            <button class="toggle" style="background:#f3f4f6;color:#111;border:0" data-id="${clinic.id}">Directions</button>
          </div>
        </div>
      `;
      return div;
    }

    function renderList(filter='', q=''){
      cards.innerHTML = '';
      const filtered = clinics.filter(c=>{
        const matchProc = filter? c.procedures.includes(filter) : true;
        const matchQ = q ? (c.name.toLowerCase().includes(q) || c.address.toLowerCase().includes(q)) : true;
        return matchProc && matchQ;
      });
      filtered.forEach(c => cards.appendChild(createCard(c)));
      // sidebar top few
      sidebarList.innerHTML = '';
      filtered.slice(0,10).forEach(c=>{
        const el = document.createElement('div');
        el.className = 'card';
        el.style.alignItems='center';
        el.innerHTML = `<div style="flex:1"><strong>${c.name}</strong><div style="font-size:13px;color:var(--muted)">${c.address}</div></div>
                        <div style="text-align:right"><div class="rating">${c.rating.toFixed(1)}</div><div style="font-size:12px;color:var(--muted)">${c.reviews.length} reviews</div></div>`;
        el.addEventListener('click', ()=>openModal(c.id));
        sidebarList.appendChild(el);
      });
      // add listeners to card buttons
      document.querySelectorAll('.card button.btn').forEach(b=>{
        b.addEventListener('click',(e)=>openModal(e.currentTarget.dataset.id));
      });
      document.querySelectorAll('.card button.toggle').forEach(b=>{
        b.addEventListener('click',(e)=> openDirections(e.currentTarget.dataset.id));
      });
    }

    // initial render
    renderList();

    // search & filter handlers
    document.getElementById('q').addEventListener('input',(e)=> {
      const q = e.target.value.trim().toLowerCase();
      const p = procedureFilter.value;
      renderList(p, q);
    });
    procedureFilter.addEventListener('change', (e)=>{
      const p = e.target.value;
      const q = document.getElementById('q').value.trim().toLowerCase();
      renderList(p, q);
    });

    // ---------- MAP ----------
    const map = L.map('map', { zoomControl:true }).setView([37.55, 126.98], 12);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    // custom icons
    const clinicIcon = L.divIcon({ className:'clinic-marker', html: '<div style="background:var(--accent);color:#fff;padding:6px 8px;border-radius:8px;font-weight:700;font-size:12px">K</div>', iconSize:[32,32]});

    const markers = {};
    clinics.forEach(c=>{
      const m = L.marker([c.lat,c.lng], { icon: clinicIcon }).addTo(map);
      m.on('click', ()=> openModal(c.id));
      m.bindTooltip(`<strong>${c.name}</strong><br/><span style="font-size:12px;color:${getComputedStyle(document.documentElement).getPropertyValue('--muted')}">${c.address}</span>`);
      markers[c.id] = m;
    });

    // ---------- MODAL ----------
    const modalRoot = document.getElementById('modalRoot');
    const modalTitle = document.getElementById('modalTitle');
    const modalAddr = document.getElementById('modalAddr');
    const modalGallery = document.getElementById('modalGallery');
    const modalReviews = document.getElementById('modalReviews');
    const modalRating = document.getElementById('modalRating');
    const openDirectionsBtn = document.getElementById('openDirections');

    function openModal(id){
      const clinic = clinics.find(x=>x.id===id);
      if(!clinic) return;
      modalTitle.textContent = clinic.name;
      modalAddr.textContent = clinic.address + ' • ' + clinic.name_kr;
      modalGallery.innerHTML = clinic.images.map(src => `<img src="${src}" alt="">`).join('');
      modalRating.textContent = `★ ${clinic.rating.toFixed(1)}`;
      modalReviews.innerHTML = clinic.reviews.map(r=>`<div class="review"><strong>${r.author}</strong> <span style="color:var(--muted);font-size:12px">• ${r.date}</span><div style="margin-top:6px">${r.text}</div><div style="color:#f59e0b;margin-top:6px">${'★'.repeat(r.rating)}</div></div>`).join('');
      openDirectionsBtn.onclick = ()=> {
        const url = `https://www.google.com/maps/search/?api=1&query=${clinic.lat},${clinic.lng}`;
        window.open(url, '_blank');
      };
      modalRoot.style.display = 'flex';
    }
    document.getElementById('closeModal').addEventListener('click', ()=> modalRoot.style.display = 'none');
    modalRoot.addEventListener('click', (e)=> { if(e.target === modalRoot) modalRoot.style.display='none' });

    function openDirections(id){
      const clinic = clinics.find(x=>x.id===id);
      if(!clinic) return;
      const url = `https://www.google.com/maps/search/?api=1&query=${clinic.lat},${clinic.lng}`;
      window.open(url, '_blank');
    }

    // ---------- View toggle ----------
    const leftMap = document.getElementById('map');
    const leftList = document.getElementById('list');
    document.getElementById('viewMap').addEventListener('click', ()=> {
      leftMap.style.display='block'; leftList.style.display='none';
      document.getElementById('viewMap').className='btn';
      document.getElementById('viewList').className='toggle';
      map.invalidateSize();
    });
    document.getElementById('viewList').addEventListener('click', ()=> {
      leftMap.style.display='none'; leftList.style.display='block';
      document.getElementById('viewMap').className='toggle';
      document.getElementById('viewList').className='btn';
    });

    // render cards area initially
    renderList();

    // small accessibility: press Esc to close modal
    document.addEventListener('keydown', (e)=> { if(e.key==='Escape') modalRoot.style.display='none'; });

  </script>
</body>
</html>
